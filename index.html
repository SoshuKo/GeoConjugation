<!DOCTYPE html>
<html lang="ka">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ジョージア語動詞活用ジェネレーター</title>
  <style>
    body { font-family: sans-serif; padding: 2em; }
    label, select, input, button { display: block; margin-top: 1em; }
    #result { margin-top: 2em; font-weight: bold; font-size: 1.2em; }
  </style>
</head>
<body>
  <h1>ジョージア語動詞活用ジェネレーター（Ⅰ型・現在亜系統）</h1>
  <label for="input">辞書形（例: გა=ა-კეთ-ებ-ს）:</label>
  <input type="text" id="input">

  <label for="tam">時制・法 (TAM):</label>
  <select id="tam">
    <option value="present">現在</option>
    <option value="imperfect">未完了過去</option>
    <option value="subjunctive">接続法現在</option>
  </select>

  <label for="person">人称:</label>
  <select id="person">
    <option value="1s">1人称単数</option>
    <option value="2s">2人称単数</option>
    <option value="3s">3人称単数</option>
    <option value="1p">1人称複数</option>
    <option value="2p">2人称複数</option>
    <option value="3p">3人称複数</option>
  </select>

  <label><input type="checkbox" id="stripHyphen"> ハイフン（- や =）を除去して出力</label>

  <button onclick="conjugate()">活用する</button>
  <div id="result"></div>

<script>
  function conjugate() {
    const input = document.getElementById('input').value.trim();
    const tam = document.getElementById('tam').value;
    const person = document.getElementById('person').value;
    const stripHyphen = document.getElementById('stripHyphen').checked;
    const result = document.getElementById('result');

    const persons = {
      '1s': ['ვ', '', 'ს', 'ი', 'ე'],
      '2s': ['', '', 'ს', 'ი', 'ე'],
      '3s': ['', '', 'ს', 'ა', 'ეს'],
      '1p': ['ვ', '', 'თ', 'ით', 'ეთ'],
      '2p': ['', '', 'თ', 'ით', 'ეთ'],
      '3p': ['', '', 'ენ', 'ნენ', 'ნენ']
    };

    const match = input.match(/^(.*)=([აეუი])-([^-]+)-([ამავებობოპივმვ]+)-([სა])$/);
    if (!match) {
      result.textContent = '形式が正しくありません。例：გა=ა-კეთ-ებ-ს';
      return;
    }

    const [, preverb, preVowel, root, marker, suffix] = match;
    const base = `${preVowel}-${root}-${marker}`;
    const [mid, , presentEnd, imperfectEnd, subjEnd] = persons[person];

    let form = '';
    const requiresPreverb = ['future', 'conditional', 'future_subjunctive'];
    if (requiresPreverb.includes(tam) && preverb === '') {
      result.textContent = 'この動詞は未来亜系統には活用できません。';
      return;
    }

    if (tam === 'present') {
      let ending = person.startsWith('3') ? presentEnd : (presentEnd === 'ს' ? '' : presentEnd);
      form = `${(person === '1s' || person === '1p') ? mid + '-' : ''}${base}${ending ? '-' + ending : ''}`;
    } else if (tam === 'imperfect') {
      form = `${(person === '1s' || person === '1p') ? mid + '-' : ''}${preVowel}-${root}-${marker}-დ-${imperfectEnd}`;
    } else if (tam === 'subjunctive') {
      form = `${(person === '1s' || person === '1p') ? mid + '-' : ''}${preVowel}-${root}-${marker}-დ-${subjEnd}`;
    } else if (tam === 'future') {
      let ending = person.startsWith('3') ? presentEnd : (presentEnd === 'ს' ? '' : presentEnd);
      form = `${(person === '1s' || person === '1p') ? mid + '-' : ''}${preverb}=${preVowel}-${root}-${marker}${ending ? '-' + ending : ''}`;
    } else if (tam === 'conditional') {
      form = `${(person === '1s' || person === '1p') ? mid + '-' : ''}${preverb}=${preVowel}-${root}-${marker}-დ-${imperfectEnd}`;
    } else if (tam === 'future_subjunctive') {
      form = `${(person === '1s' || person === '1p') ? mid + '-' : ''}${preverb}=${preVowel}-${root}-${marker}-დ-${subjEnd}`;
    }

    if (stripHyphen) {
      form = form.replace(/[\-=]/g, '');
    }

    result.textContent = `活用形: ${form}`;
  }
</script>
</body>
</html>
